---
- name: Include correct package names
  include_vars: "vars/{{ ansible_distribution }}.yml"
  when: wtd_mariadb_repository == "default"
  tags:
    - mariadb
  
# NOTE: Can be changed later to dynamically integrate scl or other repos
- name: Include correct upstream package names
  include_vars: "vars/repo_mariadb.yml"
  when: wtd_mariadb_repository == "repo_mariadb"
  tags:
    - mariadb

- name: Install MariaDB
  package:
    name: "{{ item }}"
    state: present
  with_items: "{{ wtd_mariadb_packages }}"
  tags:
    - mariadb
      
- name: Include Configuration Tasks
  include_tasks: "tasks/configure.yml"

- name: Enable and Start MariaDB
  service:
    name: mariadb
    state: started
    enabled: yes
  tags:
    - mariadb

- name: Include Secure Installation Tasks
  include_tasks: "tasks/mysql_secure_installation.yml"
